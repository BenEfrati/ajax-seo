(function(a){a.address=(function(){var d=function(al){var am=a.extend(a.Event(al),(function(){var aq={},ap=a.address.parameterNames();for(var ao=0,an=ap.length;ao<an;ao++){aq[ap[ao]]=a.address.parameter(ap[ao])}return{value:a.address.value(),path:a.address.path(),pathNames:a.address.pathNames(),parameterNames:ap,parameters:aq,queryString:a.address.queryString()}}).call(a.address));a(a.address).trigger(am);return am},j=function(al){return Array.prototype.slice.call(al)},H=function(an,am,al){a().on.apply(a(a.address),Array.prototype.slice.call(arguments));return a.address},V=function(am,al){a().off.apply(a(a.address),Array.prototype.slice.call(arguments));return a.address},O=function(){return(ae.pushState&&C.state!==I)},G=function(){return("/"+aa.pathname.replace(new RegExp(C.state),"")+aa.search+(W()?"#"+W():"")).replace(Q,"/")},W=function(){var al=aa.href.indexOf("#");return al!=-1?aa.href.substr(al+1):""},y=function(){return O()?G():W()},b=function(){try{return top.document!==I&&top.document.title!==I?top:window}catch(al){return window}},k=function(){return"javascript"},aj=function(al){al=al.toString();return(C.strict&&al.substr(0,1)!="/"?"/":"")+al},U=function(al,am){return parseInt(al.css(am),10)},ad=function(){if(!r){var am=y(),al=decodeURI(Y)!=decodeURI(am);if(al){if(h&&p<7){aa.reload()}else{if(h&&!P&&C.history){m(D,50)}_old=Y;Y=am;ab(af)}}}},ab=function(al){var an=d(F),am=d(al?g:ai);m(v,10);if(an.isDefaultPrevented()||am.isDefaultPrevented()){R()}},R=function(){Y=_old;if(O()){ae.popState({},"",C.state.replace(/\/$/,"")+(Y===""?"/":Y))}else{r=B;if(q){if(C.history){aa.hash="#"+Y}else{aa.replace("#"+Y)}}else{if(Y!=y()){if(C.history){aa.hash="#"+Y}else{aa.replace("#"+Y)}}}if((h&&!P)&&C.history){m(D,50)}if(q){m(function(){r=af},1)}else{r=af}}},v=function(){if(C.tracker!=="null"&&C.tracker!==E){var al=a.isFunction(C.tracker)?C.tracker:S[C.tracker],am=(aa.pathname+aa.search+(a.address&&!O()?a.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(a.isFunction(al)){al(am)}else{if(a.isFunction(S.urchinTracker)){S.urchinTracker(am)}else{if(S.pageTracker!==I&&a.isFunction(S.pageTracker._trackPageview)){S.pageTracker._trackPageview(am)}else{if(S._gaq!==I&&a.isFunction(S._gaq.push)){S._gaq.push(["_trackPageview",decodeURI(am)])}}}}}},D=function(){var al=k()+":"+af+";document.open();document.writeln('<html><head><title>"+ah.title.replace(/\'/g,"\\'")+"</title><script>var "+x+' = "'+encodeURIComponent(y()).replace(/\'/g,"\\'")+(ah.domain!=aa.hostname?'";document.domain="'+ah.domain:"")+"\";<\/script></head></html>');document.close();";if(p<7){e.src=al}else{e.contentWindow.location.replace(al)}},ag=function(){if(i&&c!=-1){var al,an,am=i.substr(c+1).split("&");for(al=0;al<am.length;al++){an=am[al].split("=");if(/^(autoUpdate|history|strict|wrap)$/.test(an[0])){C[an[0]]=(isNaN(an[1])?/^(true|yes)$/i.test(an[1]):(parseInt(an[1],10)!==0))}if(/^(state|tracker)$/.test(an[0])){C[an[0]]=an[1]}}i=E}_old=Y;Y=y()},T=function(){if(!Z){Z=B;ag();var am=a("body"),an=function(){u.call(this)};a(document).ajaxComplete(an);an();if(C.wrap){var ao=a("body > *").wrapAll('<div style="padding:'+(U(am,"marginTop")+U(am,"paddingTop"))+"px "+(U(am,"marginRight")+U(am,"paddingRight"))+"px "+(U(am,"marginBottom")+U(am,"paddingBottom"))+"px "+(U(am,"marginLeft")+U(am,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+x+'" style="height:100%;overflow:auto;position:relative;'+(q&&!window.statusbar.visible?"resize:both;":"")+'" />');a("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});if(q){a('<style type="text/css" />').appendTo("head").text("#"+x+"::-webkit-resizer { background-color: #fff; }")}}if(h&&!P){var al=ah.getElementsByTagName("frameset")[0];e=ah.createElement((al?"":"i")+"frame");e.src=k()+":"+af;if(al){al.insertAdjacentElement("beforeEnd",e);al[al.cols?"cols":"rows"]+=",0";e.noResize=B;e.frameBorder=e.frameSpacing=0}else{e.style.display="none";e.style.width=e.style.height=0;e.tabIndex=-1;ah.body.insertAdjacentElement("afterBegin",e)}m(function(){a(e).on("load",function(){var ap=e.contentWindow;_old=Y;Y=ap[x]!==I?ap[x]:"";if(Y!=y()){ab(af);aa.hash=Y}});if(e.contentWindow[x]===I){D()}},50)}m(function(){d("init");ab(af)},1);if(!O()){if((h&&p>7)||(!h&&P)){if(S.addEventListener){S.addEventListener(X,ad,af)}else{if(S.attachEvent){S.attachEvent("on"+X,ad)}}}else{s(ad,50)}}if("state" in window.history){a(window).trigger("popstate")}}},u=function(){var ao,ar=a("a"),ap=ar.size(),am=1,al=-1,aq='[rel*="address:"]',an=function(){if(++al!=ap){ao=a(ar.get(al));if(ao.is(aq)){ao.address(aq)}m(an,am)}};m(an,am)},o=function(){if(decodeURI(Y)!=decodeURI(y())){_old=Y;Y=y();ab(af)}},n=function(){if(S.removeEventListener){S.removeEventListener(X,ad,af)}else{if(S.detachEvent){S.detachEvent("on"+X,ad)}}},M=function(am){am=am.toLowerCase();var al=/(chrome)[ \/]([\w.]+)/.exec(am)||/(webkit)[ \/]([\w.]+)/.exec(am)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(am)||/(msie) ([\w.]+)/.exec(am)||am.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(am)||[];return{browser:al[1]||"",version:al[2]||"0"}},L=function(){var am={},al=M(navigator.userAgent);if(al.browser){am[al.browser]=true;am.version=al.version}if(am.chrome){am.webkit=true}else{if(am.webkit){am.safari=true}}return am},I,E=null,x="jQueryAddress",ac="string",X="hashchange",l="init",F="change",g="internalChange",ai="externalChange",B=true,af=false,C={autoUpdate:B,history:B,strict:B,wrap:af},A=L(),p=parseFloat(A.version),q=A.webkit||A.safari,h=!a.support.opacity,S=b(),ah=S.document,ae=S.history,aa=S.location,s=setInterval,m=setTimeout,Q=/\/{2,9}/g,ak=navigator.userAgent,P="on"+X in S,e,K,i=a("script:last").attr("src"),c=i?i.indexOf("?"):-1,J=ah.title,r=af,Z=af,N=B,w=af,z={},Y=y();_old=Y;if(h){p=parseFloat(ak.substr(ak.indexOf("MSIE")+4));if(ah.documentMode&&ah.documentMode!=p){p=ah.documentMode!=8?7:8}var t=ah.onpropertychange;ah.onpropertychange=function(){if(t){t.call(ah)}if(ah.title!=J&&ah.title.indexOf("#"+y())!=-1){ah.title=J}}}if(ae.navigationMode){ae.navigationMode="compatible"}if(document.readyState=="complete"){var f=setInterval(function(){if(a.address){T();clearInterval(f)}},50)}else{ag();a(T)}a(window).on("popstate",o).on("unload",n);return{on:function(am,an,al){return H.apply(this,j(arguments))},off:function(am,al){return V.apply(this,j(arguments))},init:function(am,al){return H.apply(this,[l].concat(j(arguments)))},change:function(am,al){return H.apply(this,[F].concat(j(arguments)))},internalChange:function(am,al){return H.apply(this,[g].concat(j(arguments)))},externalChange:function(am,al){return H.apply(this,[ai].concat(j(arguments)))},baseURL:function(){var al=aa.href;if(al.indexOf("#")!=-1){al=al.substr(0,al.indexOf("#"))}if(/\/$/.test(al)){al=al.substr(0,al.length-1)}return al},autoUpdate:function(al){if(al!==I){C.autoUpdate=al;return this}return C.autoUpdate},history:function(al){if(al!==I){C.history=al;return this}return C.history},state:function(al){if(al!==I){C.state=al;var am=G();if(C.state!==I){if(ae.pushState){if(am.substr(0,3)=="/#/"){aa.replace(C.state.replace(/^\/$/,"")+am.substr(2))}}else{if(am!="/"&&am.replace(/^\/#/,"")!=W()){m(function(){aa.replace(C.state.replace(/^\/$/,"")+"/#"+am)},1)}}}return this}return C.state},strict:function(al){if(al!==I){C.strict=al;return this}return C.strict},tracker:function(al){if(al!==I){C.tracker=al;return this}return C.tracker},wrap:function(al){if(al!==I){C.wrap=al;return this}return C.wrap},update:function(){w=B;this.value(Y);w=af;return this},title:function(al){if(al!==I){m(function(){J=ah.title=al;if(N&&e&&e.contentWindow&&e.contentWindow.document){e.contentWindow.document.title=al;N=af}},50);return this}return ah.title},value:function(al){if(al!==I){al=aj(al);if(al=="/"){al=""}if(Y==al&&!w){return}_old=Y;Y=al;if(C.autoUpdate||w){ab(B);if(O()){ae[C.history?"pushState":"replaceState"]({},"",C.state.replace(/\/$/,"")+(Y===""?"/":Y))}else{r=B;if(q){if(C.history){aa.hash="#"+Y}else{aa.replace("#"+Y)}}else{if(Y!=y()){if(C.history){aa.hash="#"+Y}else{aa.replace("#"+Y)}}}if((h&&!P)&&C.history){m(D,50)}if(q){m(function(){r=af},1)}else{r=af}}}return this}return aj(Y)},path:function(am){if(am!==I){var al=this.queryString(),an=this.hash();this.value(am+(al?"?"+al:"")+(an?"#"+an:""));return this}return aj(Y).split("#")[0].split("?")[0]},pathNames:function(){var am=this.path(),al=am.replace(Q,"/").split("/");if(am.substr(0,1)=="/"||am.length===0){al.splice(0,1)}if(am.substr(am.length-1,1)=="/"){al.splice(al.length-1,1)}return al},queryString:function(am){if(am!==I){var an=this.hash();this.value(this.path()+(am?"?"+am:"")+(an?"#"+an:""));return this}var al=Y.split("?");return al.slice(1,al.length).join("?").split("#")[0]},parameter:function(am,av,ao){var at,aq;if(av!==I){var au=this.parameterNames();aq=[];av=av===I||av===E?"":av.toString();for(at=0;at<au.length;at++){var ap=au[at],aw=this.parameter(ap);if(typeof aw==ac){aw=[aw]}if(ap==am){aw=(av===E||av==="")?[]:(ao?aw.concat([av]):[av])}for(var ar=0;ar<aw.length;ar++){aq.push(ap+"="+aw[ar])}}if(a.inArray(am,au)==-1&&av!==E&&av!==""){aq.push(am+"="+av)}this.queryString(aq.join("&"));return this}av=this.queryString();if(av){var al=[];aq=av.split("&");for(at=0;at<aq.length;at++){var an=aq[at].split("=");if(an[0]==am){al.push(an.slice(1).join("="))}}if(al.length!==0){return al.length!=1?al:al[0]}}},parameterNames:function(){var al=this.queryString(),ao=[];if(al&&al.indexOf("=")!=-1){var ap=al.split("&");for(var an=0;an<ap.length;an++){var am=ap[an].split("=")[0];if(a.inArray(am,ao)==-1){ao.push(am)}}}return ao},hash:function(am){if(am!==I){this.value(Y.split("#")[0]+(am?"#"+am:""));return this}var al=Y.split("#");return al.slice(1,al.length).join("#")}}})();a.fn.address=function(b){var d;if(typeof b=="string"){d=b;b=undefined}if(!a(this).attr("address")){var c=function(g){if(g.shiftKey||g.ctrlKey||g.metaKey||g.which==2){return true}if(a(g.target).is("a")){g.preventDefault();var f=b?b.call(g.target):/address:/.test(a(g.target).attr("rel"))?a(g.target).attr("rel").split("address:")[1].split(" ")[0]:a.address.state()!==undefined&&!/^\/?$/.test(a.address.state())?a(g.target).attr("href").replace(new RegExp("^(.*"+a.address.state()+"|\\.)"),""):a(g.target).attr("href").replace(/^(#\!?|\.)/,"");a.address.value(f)}};a(document).on("click",d?d:this.selector,c).on("submit",d?d:this.selector,function(h){if(a(h.target).is("form")){h.preventDefault();var g=a(h.target).attr("action"),f=b?b.call(h.target):(g.indexOf("?")!=-1?g.replace(/&$/,""):g+"?")+a(h.target).serialize();a.address.value(f)}}).attr("address",true)}return this}})(jQuery);