(function(a){a.address=(function(){var d=function(al){var am=a.extend(a.Event(al),(function(){var aq={},ap=a.address.parameterNames();for(var ao=0,an=ap.length;ao<an;ao++){aq[ap[ao]]=a.address.parameter(ap[ao])}return{value:a.address.value(),path:a.address.path(),pathNames:a.address.pathNames(),parameterNames:ap,parameters:aq,queryString:a.address.queryString()}}).call(a.address));a(a.address).trigger(am);return am},j=function(al){return Array.prototype.slice.call(al)},J=function(an,am,al){a().on.apply(a(a.address),Array.prototype.slice.call(arguments));return a.address},V=function(am,al){a().off.apply(a(a.address),Array.prototype.slice.call(arguments));return a.address},O=function(){return(ae.pushState&&D.state!==K)},I=function(){return("/"+aa.pathname.replace(new RegExp(D.state),"")+aa.search+(W()?"#"+W():"")).replace(Q,"/")},W=function(){var al=aa.href.indexOf("#");return al!=-1?E(aa.href.substr(al+1),af):""},z=function(){return O()?I():W()},b=function(){try{return top.document!==K&&top.document.title!==K?top:window}catch(al){return window}},k=function(){return"javascript"},aj=function(al){al=al.toString();return(D.strict&&al.substr(0,1)!="/"?"/":"")+al},E=function(al,am){if(D.crawlable&&am){return(al!==""?"!":"")+al}return al.replace(/^\!/,"")},U=function(al,am){return parseInt(al.css(am),10)},ad=function(){if(!s){var am=z(),al=decodeURI(Y)!=decodeURI(am);if(al){if(h&&p<7){aa.reload()}else{if(h&&!P&&D.history){m(F,50)}_old=Y;Y=am;ab(af)}}}},ab=function(al){var an=d(H),am=d(al?g:ai);m(w,10);if(an.isDefaultPrevented()||am.isDefaultPrevented()){R()}},R=function(){Y=_old;if(O()){ae.popState({},"",D.state.replace(/\/$/,"")+(Y===""?"/":Y))}else{s=C;if(r){if(D.history){aa.hash="#"+E(Y,C)}else{aa.replace("#"+E(Y,C))}}else{if(Y!=z()){if(D.history){aa.hash="#"+E(Y,C)}else{aa.replace("#"+E(Y,C))}}}if((h&&!P)&&D.history){m(F,50)}if(r){m(function(){s=af},1)}else{s=af}}},w=function(){if(D.tracker!=="null"&&D.tracker!==G){var al=a.isFunction(D.tracker)?D.tracker:S[D.tracker],am=(aa.pathname+aa.search+(a.address&&!O()?a.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(a.isFunction(al)){al(am)}else{if(a.isFunction(S.urchinTracker)){S.urchinTracker(am)}else{if(S.pageTracker!==K&&a.isFunction(S.pageTracker._trackPageview)){S.pageTracker._trackPageview(am)}else{if(S._gaq!==K&&a.isFunction(S._gaq.push)){S._gaq.push(["_trackPageview",decodeURI(am)])}}}}}},F=function(){var al=k()+":"+af+";document.open();document.writeln('<html><head><title>"+ah.title.replace(/\'/g,"\\'")+"</title><script>var "+y+' = "'+encodeURIComponent(z()).replace(/\'/g,"\\'")+(ah.domain!=aa.hostname?'";document.domain="'+ah.domain:"")+"\";<\/script></head></html>');document.close();";if(p<7){e.src=al}else{e.contentWindow.location.replace(al)}},ag=function(){if(i&&c!=-1){var al,an,am=i.substr(c+1).split("&");for(al=0;al<am.length;al++){an=am[al].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(an[0])){D[an[0]]=(isNaN(an[1])?/^(true|yes)$/i.test(an[1]):(parseInt(an[1],10)!==0))}if(/^(state|tracker)$/.test(an[0])){D[an[0]]=an[1]}}i=G}_old=Y;Y=z()},T=function(){if(!Z){Z=C;ag();var an=function(){v.call(this);q.call(this)},am=a("body").ajaxComplete(an);an();if(D.wrap){var ao=a("body > *").wrapAll('<div style="padding:'+(U(am,"marginTop")+U(am,"paddingTop"))+"px "+(U(am,"marginRight")+U(am,"paddingRight"))+"px "+(U(am,"marginBottom")+U(am,"paddingBottom"))+"px "+(U(am,"marginLeft")+U(am,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+y+'" style="height:100%;overflow:auto;position:relative;'+(r&&!window.statusbar.visible?"resize:both;":"")+'" />');a("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});if(r){a('<style type="text/css" />').appendTo("head").text("#"+y+"::-webkit-resizer { background-color: #fff; }")}}if(h&&!P){var al=ah.getElementsByTagName("frameset")[0];e=ah.createElement((al?"":"i")+"frame");e.src=k()+":"+af;if(al){al.insertAdjacentElement("beforeEnd",e);al[al.cols?"cols":"rows"]+=",0";e.noResize=C;e.frameBorder=e.frameSpacing=0}else{e.style.display="none";e.style.width=e.style.height=0;e.tabIndex=-1;ah.body.insertAdjacentElement("afterBegin",e)}m(function(){a(e).on("load",function(){var ap=e.contentWindow;_old=Y;Y=ap[y]!==K?ap[y]:"";if(Y!=z()){ab(af);aa.hash=E(Y,C)}});if(e.contentWindow[y]===K){F()}},50)}m(function(){d("init");ab(af)},1);if(!O()){if((h&&p>7)||(!h&&P)){if(S.addEventListener){S.addEventListener(X,ad,af)}else{if(S.attachEvent){S.attachEvent("on"+X,ad)}}}else{t(ad,50)}}if("state" in window.history){a(window).trigger("popstate")}}},v=function(){var ao,ar=a("a"),ap=ar.size(),am=1,al=-1,aq='[rel*="address:"]',an=function(){if(++al!=ap){ao=a(ar.get(al));if(ao.is(aq)){ao.address(aq)}m(an,am)}};m(an,am)},o=function(){if(decodeURI(Y)!=decodeURI(z())){_old=Y;Y=z();ab(af)}},n=function(){if(S.removeEventListener){S.removeEventListener(X,ad,af)}else{if(S.detachEvent){S.detachEvent("on"+X,ad)}}},q=function(){if(D.crawlable){var am=aa.pathname.replace(/\/$/,""),al="_escaped_fragment_";if(a("body").html().indexOf(al)!=-1){a('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var an=a(this).attr("href").replace(/^http:/,"").replace(new RegExp(am+"/?$"),"");if(an===""||an.indexOf(al)!=-1){a(this).attr("href","#"+encodeURI(decodeURIComponent(an.replace(new RegExp("/(.*)\\?"+al+"=(.*)$"),"!$2"))))}})}}},K,G=null,y="jQueryAddress",ac="string",X="hashchange",l="init",H="change",g="internalChange",ai="externalChange",C=true,af=false,D={autoUpdate:C,crawlable:af,history:C,strict:C,wrap:af},B=a.browser,p=parseFloat(B.version),h=!a.support.opacity,r=B.webkit||B.safari,S=b(),ah=S.document,ae=S.history,aa=S.location,t=setInterval,m=setTimeout,Q=/\/{2,9}/g,ak=navigator.userAgent,P="on"+X in S,e,M,i=a("script:last").attr("src"),c=i?i.indexOf("?"):-1,L=ah.title,s=af,Z=af,N=C,x=af,A={},Y=z();_old=Y;if(h){p=parseFloat(ak.substr(ak.indexOf("MSIE")+4));if(ah.documentMode&&ah.documentMode!=p){p=ah.documentMode!=8?7:8}var u=ah.onpropertychange;ah.onpropertychange=function(){if(u){u.call(ah)}if(ah.title!=L&&ah.title.indexOf("#"+z())!=-1){ah.title=L}}}if(ae.navigationMode){ae.navigationMode="compatible"}if(document.readyState=="complete"){var f=setInterval(function(){if(a.address){T();clearInterval(f)}},50)}else{ag();a(T)}a(window).on("popstate",o).on("unload",n);return{on:function(am,an,al){return J.apply(this,j(arguments))},off:function(am,al){return V.apply(this,j(arguments))},init:function(am,al){return J.apply(this,[l].concat(j(arguments)))},change:function(am,al){return J.apply(this,[H].concat(j(arguments)))},internalChange:function(am,al){return J.apply(this,[g].concat(j(arguments)))},externalChange:function(am,al){return J.apply(this,[ai].concat(j(arguments)))},baseURL:function(){var al=aa.href;if(al.indexOf("#")!=-1){al=al.substr(0,al.indexOf("#"))}if(/\/$/.test(al)){al=al.substr(0,al.length-1)}return al},autoUpdate:function(al){if(al!==K){D.autoUpdate=al;return this}return D.autoUpdate},crawlable:function(al){if(al!==K){D.crawlable=al;return this}return D.crawlable},history:function(al){if(al!==K){D.history=al;return this}return D.history},state:function(al){if(al!==K){D.state=al;var am=I();if(D.state!==K){if(ae.pushState){if(am.substr(0,3)=="/#/"){aa.replace(D.state.replace(/^\/$/,"")+am.substr(2))}}else{if(am!="/"&&am.replace(/^\/#/,"")!=W()){m(function(){aa.replace(D.state.replace(/^\/$/,"")+"/#"+am)},1)}}}return this}return D.state},strict:function(al){if(al!==K){D.strict=al;return this}return D.strict},tracker:function(al){if(al!==K){D.tracker=al;return this}return D.tracker},wrap:function(al){if(al!==K){D.wrap=al;return this}return D.wrap},update:function(){x=C;this.value(Y);x=af;return this},title:function(al){if(al!==K){m(function(){L=ah.title=al;if(N&&e&&e.contentWindow&&e.contentWindow.document){e.contentWindow.document.title=al;N=af}},50);return this}return ah.title},value:function(al){if(al!==K){al=aj(al);if(al=="/"){al=""}if(Y==al&&!x){return}_old=Y;Y=al;if(D.autoUpdate||x){ab(C);if(O()){ae[D.history?"pushState":"replaceState"]({},"",D.state.replace(/\/$/,"")+(Y===""?"/":Y))}else{s=C;if(r){if(D.history){aa.hash="#"+E(Y,C)}else{aa.replace("#"+E(Y,C))}}else{if(Y!=z()){if(D.history){aa.hash="#"+E(Y,C)}else{aa.replace("#"+E(Y,C))}}}if((h&&!P)&&D.history){m(F,50)}if(r){m(function(){s=af},1)}else{s=af}}}return this}return aj(Y)},path:function(am){if(am!==K){var al=this.queryString(),an=this.hash();this.value(am+(al?"?"+al:"")+(an?"#"+an:""));return this}return aj(Y).split("#")[0].split("?")[0]},pathNames:function(){var am=this.path(),al=am.replace(Q,"/").split("/");if(am.substr(0,1)=="/"||am.length===0){al.splice(0,1)}if(am.substr(am.length-1,1)=="/"){al.splice(al.length-1,1)}return al},queryString:function(am){if(am!==K){var an=this.hash();this.value(this.path()+(am?"?"+am:"")+(an?"#"+an:""));return this}var al=Y.split("?");return al.slice(1,al.length).join("?").split("#")[0]},parameter:function(am,av,ao){var at,aq;if(av!==K){var au=this.parameterNames();aq=[];av=av===K||av===G?"":av.toString();for(at=0;at<au.length;at++){var ap=au[at],aw=this.parameter(ap);if(typeof aw==ac){aw=[aw]}if(ap==am){aw=(av===G||av==="")?[]:(ao?aw.concat([av]):[av])}for(var ar=0;ar<aw.length;ar++){aq.push(ap+"="+aw[ar])}}if(a.inArray(am,au)==-1&&av!==G&&av!==""){aq.push(am+"="+av)}this.queryString(aq.join("&"));return this}av=this.queryString();if(av){var al=[];aq=av.split("&");for(at=0;at<aq.length;at++){var an=aq[at].split("=");if(an[0]==am){al.push(an.slice(1).join("="))}}if(al.length!==0){return al.length!=1?al:al[0]}}},parameterNames:function(){var al=this.queryString(),ao=[];if(al&&al.indexOf("=")!=-1){var ap=al.split("&");for(var an=0;an<ap.length;an++){var am=ap[an].split("=")[0];if(a.inArray(am,ao)==-1){ao.push(am)}}}return ao},hash:function(am){if(am!==K){this.value(Y.split("#")[0]+(am?"#"+am:""));return this}var al=Y.split("#");return al.slice(1,al.length).join("#")}}})();a.fn.address=function(b){var d;if(typeof b=="string"){d=b;b=undefined}if(!a(this).attr("address")){var c=function(g){if(g.shiftKey||g.ctrlKey||g.metaKey||g.which==2){return true}if(a(this).is("a")){g.preventDefault();var f=b?b.call(this):/address:/.test(a(this).attr("rel"))?a(this).attr("rel").split("address:")[1].split(" ")[0]:a.address.state()!==undefined&&!/^\/?$/.test(a.address.state())?a(this).attr("href").replace(new RegExp("^(.*"+a.address.state()+"|\\.)"),""):a(this).attr("href").replace(/^(#\!?|\.)/,"");a.address.value(f)}};a(d?d:this).on("click",c).on("submit",function(h){if(a(this).is("form")){h.preventDefault();var g=a(this).attr("action"),f=b?b.call(this):(g.indexOf("?")!=-1?g.replace(/&$/,""):g+"?")+a(this).serialize();a.address.value(f)}}).attr("address",true)}return this}})(jQuery);