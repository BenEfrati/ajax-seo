Options -Indexes +FollowSymLinks -MultiViews

ServerSignature Off

## Uncomment php_flag's and php_value if you're not able use content/php.ini settings on your server
#php_flag display_errors 0
#php_flag log_errors 1
#php_value error_log error_log.txt
#php_flag session.use_trans_sid 0
#php_flag allow_url_fopen 0
#php_flag allow_url_include 0
#php_flag short_open_tag 0
#php_flag magic_quotes_gpc 0
#php_flag safe_mode 0
#php_flag register_globals 0
#php_flag expose_php 0

AddType text/javascript .js
AddType text/cache-manifest appcache
AddType application/json .json
AddType image/x-icon .ico

AddDefaultCharset utf-8
AddCharset utf-8 .json .css .js .txt

<IfModule mod_deflate.c>
    <IfModule mod_setenvif.c>
        <IfModule mod_headers.c>
            SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
            RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
            BrowserMatch MSIE ie
            Header set X-UA-Compatible "IE=Edge,chrome=1" env=ie
            Header set X-Content-Type-Options "nosniff" env=ie
            Header set X-XSS-Protection "1; mode=block" env=ie
            <FilesMatch "\.php$">
                Header set Imagetoolbar "no" env=ie
            </FilesMatch>
        </IfModule>
    </IfModule>
    <IfModule filter_module>
        FilterDeclare   COMPRESS
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $application/json
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $application/xml
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $text/html
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $text/plain
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $text/css
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $text/javascript
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $image/svg+xml
        FilterProvider  COMPRESS  DEFLATE resp=Content-Type $image/x-icon
        FilterChain     COMPRESS
        FilterProtocol  COMPRESS  DEFLATE change=yes;byteranges=no
    </IfModule>
    <IfModule !mod_filter.c>
        AddOutputFilterByType DEFLATE application/json application/xml text/html text/plain text/css text/javascript image/svg+xml image/x-icon
    </IfModule>
</IfModule>
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 month"
    ExpiresByType application/x-httpd-php "access plus 1 minute"
    ExpiresByType application/json "access plus 1 minute"
    ExpiresByType application/xml "access plus 1 minute"
    ExpiresByType text/html "access plus 1 minute"
    ExpiresByType text/plain "access plus 1 hour"
    ExpiresByType text/cache-manifest "access plus 0 seconds"
    ExpiresByType text/css "access plus 6 months"
    ExpiresByType text/javascript "access plus 6 months"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 week"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
</IfModule>
<IfModule mod_headers.c>
    <FilesMatch "\.php$">
        Header set Cache-Control max-age=60
    </FilesMatch>
    <FilesMatch "\.(css|js|json|xml|txt)$">
        Header set Cache-Control max-age=31536000
        Header set X-Robots-Tag none
    </FilesMatch>
    <FilesMatch (robots.txt|humans.txt|sitemap.xml)>
        Header set X-Robots-Tag "noindex, follow"
        SetHandler application/x-httpd-php
    </FilesMatch>
    <FilesMatch "\.(png|jpg|gif|svg)$">
        Header set Cache-Control max-age=2419200
    </FilesMatch>
    FileETag None
    Header unset Pragma
    Header unset X-Powered-By
    Header unset Accept-Ranges
    Header append Cache-Control public
    Header append Vary Accept-Encoding
</IfModule>
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Rewrite www to no-www domain
    RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
    RewriteRule .* http://%1%{REQUEST_URI} [R=301,L]
    
    # Rewrite multiple slashes with single slash after domain
    RewriteCond %{THE_REQUEST} ^[A-Z]+\s//+(.*)\sHTTP/[0-9.]+$ [OR]
    RewriteCond %{THE_REQUEST} ^[A-Z]+\s(.*/)/+\sHTTP/[0-9.]+$
    RewriteRule .* http://%{HTTP_HOST}/%1 [R=301,L,NE]
    
    # Rewrite multiple slashes with single slash in URL
    RewriteCond %{REQUEST_URI} ^(.*)//(.*)$
    RewriteRule . %1/%2 [R=301,NE,L]
    
    # Remove slash from URL end
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} ^(.+)/$
    RewriteRule ^.+/$ %1 [R=301,NE,L]
    
    # Rewrite backslash with slash
    ## Works on FF with using AllowEncodedSlashes On in content/httpd.conf
    RewriteCond %{REQUEST_URI} ^(.*)\\(.*)$
    RewriteRule .* %1/%2 [R=301,NC,L]
    
    # Rewrite query string, Ajax crawling
    RewriteCond %{QUERY_STRING} ^_escaped_fragment_=(.*)$
    RewriteRule .*$ %{REQUEST_URI}%1? [R=301,L]
    RewriteCond %{QUERY_STRING} ^.+$
    RewriteCond %{QUERY_STRING} !^url=
    RewriteCond %{QUERY_STRING} !api
    RewriteRule .*$ %{REQUEST_URI}? [R=301,L]
    
    # Rewrite space with dash
    RewriteCond %{REQUEST_URI} ^([^\ ]*)\ (.*)$
    RewriteRule .* %1-%2 [R=301,L]
    
    # Rewrite underscore with dash
    RewriteCond %{REQUEST_URI} ^([^\_]*)\_(.*)$
    RewriteRule .* %1-%2 [R=301,L]
    
    # Remove dot
    RewriteCond %{REQUEST_URI} ^([^\.]*)\.(.*)$
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule .* %1%2 [R=301,L]
    
    # Remove comma
    RewriteCond %{REQUEST_URI} ^([^\,]*)\,(.*)$
    RewriteRule .* %1%2 [R=301,L]
    
    # Remove dash before slash
    RewriteCond %{REQUEST_URI} ^(.*)\-/(.*)$
    RewriteRule ^(.*)\-/(.*)$  %1/%2 [R=301,L]
    
    # Remove dash after slash
    RewriteCond %{REQUEST_URI} ^(^\.)\/-(.*)$
    RewriteRule ^(.*)\/-(.*)$  %1/%2 [R=301,L]
    
    # Remove .php extension
    RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^/]+/)*[^.]+\.php(\?[^\ ]*)?\ HTTP/ [NC]
    RewriteRule ^(([^/]+/)*[^.]+)\.php$ http://%{HTTP_HOST}/%1$1 [R=301,L]
    
    # Rewrite uppercase letter URL to lowercase with content/httpd.conf RewriteMap lc int:tolower
    ## Solution without httpd.conf RewriteMap in github.com/laukstein/ajax-seo/wiki/Lowercase-URL
    RewriteCond %{REQUEST_URI} .+
    RewriteRule ^[^A-Z]*[A-Z] ${lc:%0} [R=301,L]
    
    # Block folder access that begins with a period (like .git, .svn)
    RewriteRule "(^|/)\." - [F]
    
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^api/?([^\./]*)$ ?api&url=$1 [L,QSA]
    RewriteRule ^([^.]*)$ ?url=$1 [L,QSA]
    
    RewriteRule .* - [E=HTTP_IF_MODIFIED_SINCE:%{HTTP:If-Modified-Since}]
    RewriteRule .* - [E=HTTP_IF_NONE_MATCH:%{HTTP:If-None-Match}]
</IfModule>