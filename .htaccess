Options -Indexes +FollowSymLinks -MultiViews

ServerSignature Off

php_flag display_errors 0
php_flag log_errors 1
php_value error_log error_log.txt
php_flag session.use_trans_sid 0
php_flag allow_url_fopen 0
php_flag short_open_tag 0
php_flag magic_quotes_gpc 0
php_flag safe_mode 0
php_flag register_globals 0
php_flag expose_php 0
#<FilesMatch index.php>
#    php_value output_handler ob_gzhandler
#</FilesMatch>

AddType text/javascript .js
AddType application/json .json
AddType image/x-icon .ico

AddDefaultCharset utf-8
AddCharset utf-8 .json .css .js .txt

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/x-httpd-php application/json application/xml text/html text/plain text/css text/javascript image/svg+xml image/x-icon
    <IfModule mod_setenvif.c>
        BrowserMatch ^Mozilla/4 gzip-only-text/html
        BrowserMatch ^Mozilla/4\.0[678] no-gzip
        BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
        SetEnvIf User-Agent ".*MSIE.*" \
        nokeepalive ssl-unclean-shutdown \
        downgrade-1.0 force-response-1.0
        <IfModule mod_headers.c>
            BrowserMatch MSIE ie
            Header set X-UA-Compatible "IE=Edge,chrome=1" env=ie
        </IfModule>
    </IfModule>
</IfModule>
<IfModule mod_gzip.c>
    mod_gzip_on Yes
    mod_gzip_can_negotiate Yes
    mod_gzip_static_suffix .gz
    AddEncoding gzip .gz
    mod_gzip_update_static No
    mod_gzip_keep_workfiles No
    mod_gzip_minimum_file_size 500
    mod_gzip_maximum_file_size 5000000
    mod_gzip_maximum_inmem_size 60000
    mod_gzip_min_http 1000
    mod_gzip_dechunk Yes
    mod_gzip_handle_methods GET POST
    mod_gzip_item_include file \.(php|json|xml|txt|css|js|svg|ico)$
    mod_gzip_item_include mime ^application/x-httpd-php$
    mod_gzip_item_include mime ^application/json$
    mod_gzip_item_include mime ^application/xml
    mod_gzip_item_include mime ^text/html$
    mod_gzip_item_include mime ^text/plain$
    mod_gzip_item_include mime ^text/css$
    mod_gzip_item_include mime ^text/javascript$
    mod_gzip_item_include mime ^image/svg+xml$
    mod_gzip_item_include mime ^image/x-icon$
    mod_gzip_item_include mime ^httpd/unix-directory$
    mod_gzip_item_include handler ^proxy-server$
    mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
    mod_gzip_send_vary On
</IfModule>
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 month"
    ExpiresByType application/x-httpd-php "access plus 0 second"
    ExpiresByType application/json "access plus 0 second"
    ExpiresByType application/xml "access plus 0 second"
    ExpiresByType text/html "access plus 0 second"
    ExpiresByType text/plain "access plus 1 hour"
    ExpiresByType text/css "access plus 6 months"
    ExpiresByType text/javascript "access plus 6 months"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 week"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
</IfModule>
<IfModule mod_headers.c>
    <FilesMatch "\.php$">
        Header set Cache-Control "private, max-age=0"
        Header set Imagetoolbar no
    </FilesMatch>
    <FilesMatch "\.(css|js|json|txt)$">
        Header set Cache-Control "public, max-age=31536000"
        Header set X-Robots-Tag none
        Header append Vary Accept-Encoding
        #Header set Content-Encoding: gzip
    </FilesMatch>
    <FilesMatch (robots\.txt|sitemap\.xml)>
        Header set X-Robots-Tag "noindex, follow"
        SetHandler application/x-httpd-php
        ## Some servers are using application/x-httpd-php5 beside of application/x-httpd-php
        ##SetHandler application/x-httpd-php5
    </FilesMatch>
    <FilesMatch "\.(png|jpg|gif|svg)$">
        Header set Cache-Control "public, max-age=2419200"
    </FilesMatch>
    FileETag None
    Header unset ETag
    Header unset X-Powered-By
    Header unset Pragma
    #Header unset Last-Modified
    Header set X-Content-Type-Options: nosniff
</IfModule>
#<IfModule mod_security.c>
#    SecFilterEngine On
#    SecAuditEngine RelevantOnly
#    SecFilterDebugLevel 0
#    SecFilterCheckURLEncoding On
#    SecFilterCheckUnicodeEncoding Off
#    SecFilterScanPOST On
#    SecFilterDefaultAction "deny,log,status:500"
#</IfModule>
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Rewrite www to no-www domain
    #RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
    RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
    RewriteRule .* http://%1%{REQUEST_URI} [R=301,L]
    
    # Rewrite multiple slashes with single slash after domain
    RewriteCond %{THE_REQUEST} ^[A-Z]+\s//+(.*)\sHTTP/[0-9.]+$ [OR]
    RewriteCond %{THE_REQUEST} ^[A-Z]+\s(.*/)/+\sHTTP/[0-9.]+$
    RewriteRule .* http://%{HTTP_HOST}/%1 [R=301,L,NE]
    
    # Rewrite multiple slashes with single slash in URL
    RewriteCond %{REQUEST_URI} ^(.*)//(.*)$
    RewriteRule . %1/%2 [R=301,NE,L]
    
    # Remove slash from URL end
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} ^(.+)/$
    RewriteRule ^.+/$ %1 [R=301,NE,L]
    
    # Rewrite backslash with slash
    ## works on FF with using AllowEncodedSlashes On in httpd.conf
    RewriteCond %{REQUEST_URI} ^(.*)\\(.*)$
    RewriteRule .* %1/%2 [R=301,NC,L]
    
    # Ajax SEO crawl /?_escaped_fragment_=url redirect to /url
    RewriteCond %{QUERY_STRING} ^_escaped_fragment_=(.*)$
    RewriteRule .*$ %{REQUEST_URI}%1? [R=301,L]
    
    # Rewrite space with dash
    RewriteCond %{REQUEST_URI} ^([^\ ]*)\ (.*)$
    RewriteRule .* %1-%2 [R=301,L]
    
    # Rewrite underscore with dash
    RewriteCond %{REQUEST_URI} ^([^\_]*)\_(.*)$
    RewriteRule .* %1-%2 [R=301,L]
    
    # Remove comma
    RewriteCond %{REQUEST_URI} ^([^\,]*)\,(.*)$
    RewriteRule .* %1%2 [R=301,L]
    
    # Remove dot before slash
    RewriteCond %{REQUEST_URI} ^(.*)\./(.*)$
    RewriteRule ^(.*)\./(.*)$  %1/%2 [R=301,L]
    
    # Remove dot after slash
    RewriteCond %{REQUEST_URI} ^(.*)/\.(.*)$
    RewriteRule ^(.*)/\.(.*)$ %1/%2 [R=301,L]
    
    # Remove .php extension
    RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^/]+/)*[^.]+\.php(\?[^\ ]*)?\ HTTP/ [NC]
    RewriteRule ^(([^/]+/)*[^.]+)\.php$ http://%{HTTP_HOST}/%1$1 [R=301,L]
    
    # Rewrite uppercase letter URL to lowercase
    ## solution without using RewriteMap in httpd.conf - https://github.com/laukstein/ajax-seo/wiki/Lowercase-URL
    RewriteCond %{REQUEST_URI} .+
    RewriteRule ^[^A-Z]*[A-Z] ${lc:%0} [R=301,L]
    
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^api/?([^\./]*)$ ?api&url=$1 [L,QSA]
    RewriteRule ^([^.]*)$ ?url=$1 [L,QSA]
    
    RewriteRule .* - [E=HTTP_IF_MODIFIED_SINCE:%{HTTP:If-Modified-Since}]
    RewriteRule .* - [E=HTTP_IF_NONE_MATCH:%{HTTP:If-None-Match}]
</IfModule>